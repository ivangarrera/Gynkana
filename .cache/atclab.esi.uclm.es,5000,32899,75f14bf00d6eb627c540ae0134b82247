status: 200
date: Mon, 03 Apr 2017 14:52:37 GMT
content-type: text/plain; charset=utf-8
server: BaseHTTP/0.3 Python/2.7.9
content-location: http://atclab.esi.uclm.es:5000/32899

68058
You passed the step 3!

Step 4: Ping
-------------

- You must send an ICMP Echo Request message to atclab.esi.uclm.es.
  the payload of this message must include, AFTER the usual
  content, the ASCII string "68058".

     +--------------+----------------------------+
     | Echo Request |                            |
     | Header       | timestamp(8 bytes) + 68058 |
     +--------------+----------------------------+

- You will receive an ICMP Echo Reply message with the instructions to
  continue.

You have 5 seconds.

Hints:
- Using wireshark, analyze the content and size of a conventional ping
  message. You can send pings that are shorter than normal with "ping -s size".
- Study the chapter "RAW Sockets" in the lab manual.
- Remember that to use raw sockets you must run the program with
  admin privileges.
- Build an ICMP message mimicking the one you have captured. Identical
  at first. If it works, add your changes step by step.
- To construct the message you can use struct.pack().
- You can use the checksum calculation function in
  https://bitbucket.org/arco_group/python-net/src/tip/raw/icmp_checksum.py
- Constructs the ICMP message indicating a 0 in the checksum field. Calculate the
  checksum and rebuilds the message using the calculation result.
